"use strict";var f=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var P=(e,t)=>{for(var n in t)f(e,n,{get:t[n],enumerable:!0})},J=(e,t,n,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of D(t))!F.call(e,s)&&s!==n&&f(e,s,{get:()=>t[s],enumerable:!(c=j(t,s))||c.enumerable});return e};var N=e=>J(f({},"__esModule",{value:!0}),e);var b={};P(b,{default:()=>x});module.exports=N(b);var r=require("@raycast/api");var w=require("@raycast/api"),y=require("path"),g=require("fs/promises"),h=require("child_process");async function O(e,...t){if(process.platform==="win32")return Promise.reject(new Error("Swift functions are not supported on Windows"));let n=(0,y.join)(w.environment.assetsPath,"compiled_raycast_swift","Ruler");return await(0,g.chmod)(n,"755"),new Promise((c,s)=>{let p=[e];for(let i of t)try{p.push(JSON.stringify(i,(o,a)=>a===void 0?null:a))}catch(o){s(new d("Failed to serialize input to JSON: "+o.message));return}let m=(0,h.spawn)(n,p),u=[],l=[];m.stdout?.on("data",i=>{u.push(i.toString())}),m.stderr?.on("data",i=>{l.push(i.toString())}),m.on("exit",i=>{if(i===0)try{let o=u.join("").trim();o.length!=0?c(JSON.parse(o)):c(null)}catch(o){let a=new d("Failed to deserialize result from JSON: "+o.message);a.stdout=u.join("").trim(),a.stderr=l.join("").trim(),s(a)}else{let o=new d(l.join("").trim()||u.join("").trim()||"Could not get any data");o.stdout=u.join("").trim(),o.stderr=l.join("").trim(),s(o)}}),m.on("error",i=>{s(i)})})}async function S(e){return await O("measureDistance",e)}var d=class extends Error{constructor(t){super(t),this.name="SwiftError"}};async function x(){await(0,r.closeMainWindow)();try{let e=await(0,r.getPreferenceValues)(),t=await S(e.dragMode);if(!t)return;let n=`Distance: ${t} pixels`;e.copyToClipboard&&(n=`Distance of ${t} pixels successfully copied to clipboard`,await r.Clipboard.copy(t)),await(0,r.showToast)({style:r.Toast.Style.Success,title:n})}catch{await(0,r.showToast)({style:r.Toast.Style.Failure,title:"Failed to measure distance"})}}
